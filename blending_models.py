import pandas as pd

filepath = 'submit_history/'

df1 = pd.read_csv(filepath + 'lgb_40529_355_submit.csv')
df2 = pd.read_csv(filepath + 'lgb_40549_362_submit.csv')
df3 = pd.read_csv(filepath + 'lgb_60530_358_submit.csv')
df4 = pd.read_csv(filepath + 'lgb_60530_525_submit.csv')
df5 = pd.read_csv(filepath + 'lgb_60531_355_submit.csv')
df6 = pd.read_csv(filepath + 'lgb_63101_350_submit.csv')
df7 = pd.read_csv(filepath + 'stacking2_submit1227.csv')

df1 = pd.concat([df1, df2])
df1 = pd.concat([df1, df3])
df1 = pd.concat([df1, df4])
df1 = pd.concat([df1, df5])
df1 = pd.concat([df1, df6])
df1 = pd.concat([df1, df7])

tmp = df1.groupby('md5').mean()
tmp = tmp.reset_index()

tmp["Backdoor"] = tmp["Backdoor"].astype('float32')
tmp["PUA"] = tmp["PUA"].astype('float32')
tmp["PWS"] = tmp["PWS"].astype('float32')
tmp["Ransom"] = tmp["Ransom"].astype('float32')
tmp["SoftwareBundler"] = tmp["SoftwareBundler"].astype('float32')
tmp["Trojan"] = tmp["Trojan"].astype('float32')
tmp["TrojanDownloader"] = tmp["TrojanDownloader"].astype('float32')
tmp["VirTool"] = tmp["VirTool"].astype('float32')
tmp["Virus"] = tmp["Virus"].astype('float32')
tmp["Worm"] = tmp["Worm"].astype('float32')

assert tmp.sum(axis=1).sum() == 5000
tmp.to_csv(filepath + 'final_submit.csv', index=False)